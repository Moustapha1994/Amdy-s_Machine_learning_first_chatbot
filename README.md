# chatbot


Драме Амди Мустафа
С.б: 1032189097
Группа: НФИмд-01-19

Создание бота 

В этом проекте Python мы построим chatbot с использованием методов глубокого обучения. Chatbot будет обучен набору данных, который содержит категории (intents. json), модель и ответы. Мы используем специальную повторяющуюся нейронную сеть (LSTM) для классификации категории, к которой относится сообщение пользователя, а затем дадим случайный ответ из списка ответов.
Давайте создадим чатбот на основе восстановления с использованием NLTK, Keras, Python и т. д.
В этом проекте я использую командную строку anaconda с виртуальной средой (tf-gpu), чтобы не иметь проблемы с версиями библиотек и модулей.

Начнем с установки с помощью следующих команд

conda create -n tf-gpu tensorflow-gpu
эта строка позволяет нам установить tensorflow в виртуальной среде (tf-gpu), которую нам нужно активировать с помощью следующей команды :
conda activate
1. Импорт и загрузка файла данных
Сначала мы создаем файл с именем 'intents.json', который содержит набор данных, который мы будем использовать. Это файл JSON, который содержит шаблоны, которые нам нужно найти, и ответы, которые мы хотим вернуть пользователю.
После этого мы затем создаем имя файла python, например train_bot21.py. Мы импортируем необходимые пакеты для нашего chatbot и инициализируем переменные, которые мы будем использовать в нашем проекте Python. Поэтому мы использовали пакет json для разбора файла JSON в python.


Файл intents.json, который мы будем использовать, выглядит следующим образом :


2. Данные предварительной обработки
В нашем файле python train_bot21.py, мы сделаем притворство.


Когда мы работаем с текстовыми данными, нам нужно выполнить различные предварительные обработки данных, прежде чем создавать модель машинного обучения или глубокого обучения. Токенизация - это первое, что мы можем сделать с текстовыми данными. Tokenizing-это процесс разбиения всего текста на небольшие части, такие как слова.

Здесь мы просматриваем шаблоны и бросаем предложение с помощью функции nltk.word_tokenize ()и добавляем каждое слово в список слов. Мы также создаем список классов для наших тегов.


Теперь давайте лемматизировать каждое слово и удалить дубликаты слов из списка. Лемматизация-это процесс преобразования слова в его форму леммы, а затем создания файла рассола для хранения объектов Python, которые мы будем использовать при прогнозировании.



3. Создание данных обучения и тестирования

Теперь мы создадим обучающие данные, в которых мы будем предоставлять вход и выход. Наш вклад будет модель и выход будет класс нашей модели входа принадлежит. Но компьютер не понимает текст, поэтому мы преобразуем текст в числа.



4. Построить модель

У нас есть наши тренировочные данные, теперь мы построим глубокую нейронную сеть, которая имеет 3 слоя. Для этого мы используем последовательный API Keras. Обучив модель в течение 200 эпох, мы достигли 100% точности на нашей модели. Сохраните модель как ' Amdy_chatbot_model.h5’.



5. Предсказать ответ (графический интерфейс пользователя)

Теперь, чтобы предсказать фразы и получить ответ от пользователя, чтобы мы могли создать новый файл ‘bot21.py".

Мы загрузим обученную модель, а затем используем графический пользовательский интерфейс, который будет предсказывать ответ бота. Модель скажет нам только класс, к которому он принадлежит, поэтому мы будем реализовывать некоторые функции, которые будут определять класс, а затем мы получим случайный ответ из списка ответов.
Опять же, мы импортируем необходимые пакеты и загружаем файлы pickle ' words. pkl’ and ‘classes. pkl’, которые мы создали, когда мы сформировали нашу модель:


Чтобы предсказать класс, нам нужно будет предоставить обратную связь так же, как мы это делали во время обучения. Поэтому мы создадим функции, которые будут выполнять предварительную обработку текста, а затем предсказать класс.

После предсказания класса мы получим случайный ответ из списка намерений.


Теперь давайте закодировать графический пользовательский интерфейс. Для этого мы используем библиотеку Tkinter, которая уже поставляется в python. Мы возьмем сообщение ввода пользователя, а затем использовать вспомогательные функции, которые мы создали, чтобы получить ответ от бота и отобразить его на графическом интерфейсе.





6. Выполняем chatbot
Для запуска chatbot у нас есть два основных файла; train_bot21.py и bot21.py.
Во-первых, мы тренируем модель с помощью команды в терминале :
Python train_bot21.py

Затем, чтобы запустить приложение, мы запускаем второй файл.

Python bot21.py




Давайте объясним файлы нашего проекта
    • Intents. json-файл данных, который имеет предопределенные шаблоны и ответы.
    • train_bot21.py – в этом файле Python мы написали скрипт для создания модели и обучения нашему чатботу.
    • Words.pkl – это файл pickle, в котором мы храним слова объект Python, который содержит список нашего словаря.
    • classes.pkl – файл классов рассол содержит список категорий.
    • Amdy_Chatbot_model.h5 – это тренированная модель, которая содержит информацию о модели и имеет веса нейронов.
    • bot21.py -это скрипт Python, в котором мы реализовали графический интерфейс для нашего chatbot. Пользователи могут легко взаимодействовать с ботом.
